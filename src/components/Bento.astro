---
import { Image } from "astro:assets";
import OmnifoodIcon from "./icons/omnifood-logo.webp";
import CrwnIcon from "./icons/CrwnIcon.astro";
import ForkifyIcon from "./icons/forkify-icon.webp";
import PathFinderIcon from "./icons/PathIcon.astro";
import Title from "./Title.astro";
import ProjectFooter from "./ProjectFooter.astro";
import Divider from "./Divider.astro";

const projects = {
  omnifood: {
    title: "Omnifood",
    description:
      "Elevate your health journey with a captivating landing page design for a fictional healthy delivery service – where wellness meets seamless online experience.",
    tech: ["HTML", "CSS", "JS"],
    link: "https://andres-omnifood.netlify.app/",
    github: "https://github.com/dresan22/omnifood-lp",
    image: OmnifoodIcon,
  },
  crwn: {
    title: "Crwn",
    description:
      "Dynamic E-commerce Platform: Elevating Fashion Trends Online – A sleek and intuitive shopping website offering a curated collection of modern, trend-setting clothing for a seamless and stylish online shopping experience",
    tech: ["HTML", "CSS", "JS"],
    link: "https://crwn-clothing-dresan22.vercel.app",
    github: "https://github.com/dresan22/crwn-clothing",
    image: CrwnIcon,
  },
  pathfinder: {
    title: "Path Finder",
    description:
      "AI-powered Career Navigator: A cutting-edge web platform that leverages artificial intelligence to analyze individual skills, preferences, and market trends, guiding users towards personalized and fulfilling career paths.",
    tech: ["HTML", "CSS", "JS"],
    link: "https://findmypath.vercel.app",
    github: "https://github.com/dresan22/PathFinder",
    image: PathFinderIcon,
  },
  forkify: {
    title: "Forkify",
    description:
      "Engaging React-powered project for a interactive recipe platform, featuring seamless navigation, and a modern UI for an enhanced culinary experience.",
    tech: ["HTML", "CSS", "JS", "React"],
    link: "https://forkify-andres.netlify.app/",
    github: "https://github.com/dresan22/forkify-andres",
    image: ForkifyIcon,
  },
};
---

<!-- TODO: add wrapper to add shadow on divider -->
<div
  class="relative bg-[radial-gradient(ellipse_90%_90%_at_50%_-20%,rgba(0,0,0,0.95),rgba(0,0,0,0.045))] duration-700 z-10 min-h-[calc(100vh+var(--angle-divider))] py-[calc(var(--angle-divider)*2)] grid place-items-center middle inset-shadow"
  id="parent"
>
  <Title text="Projects" />
  <section
    id="child"
    class="w-full max-w-[70vw]
    grid lg:grid-cols-10 auto-rows-[35vh] gap-5
    mx-auto pt-20 text-white h-full place-content-center [&>article]:grid [&>article]:grid-cols-1 [&>article]:place-content-center [&>article]3xl:place-content-center [&>article]:rounded-xl [&>article]:backdrop-blur-m [&>article]:p-5 [&>article]:md:p-10 [&>article]:gap-3 [&>article]:duration-300 [&>article]:overflow-hidden [&_p]:text-xs [&_p]:md:text-base [&_p]:2xl:text-lg [&>article>p]:font-normal [&>article]:shadow-lg [&>article]:relative [&>article]:grayscale [&>article:hover]:grayscale-0"
  >
    <!-- PROJECT 1: OMNIFOOD ----------------------------------------------->
    <article
      class="md:col-span-4 bg-gradient-to-r from-orange-200 via-amber-100 to-slate-100 text-[#333]"
    >
      <Image src={projects.omnifood.image} alt="Omnifood logo" class="" />
      <p class="font-['Rubik system-ui'] text-pretty">
        {projects.omnifood.description}
      </p>
      <ProjectFooter project={projects.omnifood} />
    </article>
    <!-- PROJECT 2:CRWN -------------------------------------------------->
    <article
      class="bg-gradient-to-b from-blue-100 via-gray-500 to-blue-400 md:col-span-6 text-right text-white"
    >
      <div class="absolute max-h-full w-full left-[-20%] bottom-0 z-10 grid">
        <projects.crwn.image />
      </div>
      <div class="z-20">
        <h2 class="text-3xl md:text-6xl drop-shadow-lg">Crwn</h2>
        <p class="font-['Rubik system-ui']">
          {projects.crwn.description}
        </p>
      </div>
      <ProjectFooter project={projects.crwn} />
    </article>
    <!-- PROJECT 3: PATH FINDER -------------------------------------------------->
    <article
      class="bg-slate-800 md:col-span-6 bg-[radial-gradient(ellipse_at_top_right,_var(--tw-gradient-stops))] from-indigo-900 via-indigo-900 to-teal-900"
    >
      <div
        class="size-[150px] lg:size-[400px] absolute left-[20%] -top-0 rotate-90 opacity-40"
      >
        <projects.pathfinder.image />
      </div>
      <div class="z-50">
        <h2
          class="bg-gradient-to-r from-blue-300 to-purple-300 bg-clip-text font-extrabold text-transparent tracking-wide text-3xl md:text-5xl drop-shadow-dark drop-shadow-lg"
        >
          Path Finder
        </h2>
        <p class="font-['Rubik system-ui']">
          {projects.pathfinder.description}
        </p>
      </div>
      <ProjectFooter project={projects.pathfinder} />
    </article>
    <!--PROJECT 4: FORKIFY -------------------------------------------------->
    <article
      class=`	      bg-slate-800   md:col-span-4 bg-gradient-to-l from-orange-200 via-yellow-200 to-amber-100    text-[#333]   place-content-start `
    >
      <div class="mb-1 grid gap-1">
        <Image
          src={projects.forkify.image}
          alt="Omnifood logo"
          class="drop-shadow-xl w-[80%] mx-auto"
        />
        <p class="font-['system-ui'] text-right">
          {projects.forkify.description}
        </p>
      </div>
      <ProjectFooter project={projects.forkify} />
    </article>
  </section>
  <div
    id="article-backdrop"
    class={`
       absolute  rounded
        translate-x-[var(--left)] translate-y-[var(--top)]
        left-0 top-0
        w-[var(--width)] h-[var(--height)]
         duration-1000
        ease-out opacity-0 -z-10
        blur-[80px]
        `}
  >
  </div>
</div>
<Divider />
<style is:global>
  @keyframes fade-in {
    100% {
      opacity: 1;
      scale: 1;
    }
  }

  section article {
    opacity: 0.1;
    scale: 0.8;
    animation: fade-in linear forwards;
    animation-timeline: view();
    animation-range: 0px 15%;
  }

  .inset-shadow {
    box-shadow: inset 0px 0px 150px black;
  }
</style>
<script>
  const parent = document.getElementById("parent");

  // -------------------------------------------------
  window.addEventListener("DOMContentLoaded", (event) => {
    const articleItems = document.querySelectorAll("section article");
    const articleBackDrop = document.querySelector(
      "#article-backdrop"
    ) as HTMLElement;

    setTimeout(() => {
      const firstItem = articleItems[0] as HTMLElement;
      const left = firstItem.offsetLeft;
      const top = firstItem.offsetTop;

      articleBackDrop.style.transition = "none";
      articleBackDrop.style.setProperty("--left", `${left}px`);
      articleBackDrop.style.setProperty("--top", `${top}px`);
      articleBackDrop.style.opacity = "0";
      articleBackDrop.style.visibility = "hidden";

      setTimeout(() => {
        articleBackDrop.style.transition = "";
      }, 50);
    }, 100);

    articleItems.forEach((item: HTMLElement, index) => {
      item.addEventListener("mouseenter", () => {
        parent.classList.add("backdrop-blur-[1px]");

        const { width, height } = item.getBoundingClientRect();
        const left = item.offsetLeft;
        const top = item.offsetTop;
        articleBackDrop.style.setProperty("--left", `${left}px`);
        articleBackDrop.style.setProperty("--top", `${top}px`);
        articleBackDrop.style.setProperty("--width", `${width}px`);
        articleBackDrop.style.setProperty("--height", `${height}px`);

        switch (index) {
          case 0:
            articleBackDrop.style.backgroundColor = "#eab308";
            break;
          case 1:
            articleBackDrop.style.backgroundColor = "#3b82f6";
            break;
          case 2:
            articleBackDrop.style.backgroundColor = "#1e40af";
            break;
          default:
            articleBackDrop.style.backgroundColor = "#eab308";
        }

        articleBackDrop.style.opacity = "1";
        articleBackDrop.style.visibility = "visible";
      });

      item.addEventListener("mouseleave", () => {
        parent.classList.remove("backdrop-blur-[1px]");

        articleBackDrop.style.opacity = "0";
        articleBackDrop.style.visibility = "hidden";
      });
    });

    window.addEventListener("DOMContentLoaded", (event) => {
      const articleItems = document.querySelectorAll("section article");

      articleItems.forEach((item) => {
        item.classList.add("transition");
      });
    });
  });

  // -------------------------------------------------
  // LINES GRID
  // window.onload = function () {
  //   document.documentElement.style.setProperty("--color", colorObj["letter-n"]);
  //   document.documentElement.style.setProperty(
  //     "--color2",
  //     colorObj["letter-d"]
  //   );
  // };
  // -------------------------------------------------
</script>
